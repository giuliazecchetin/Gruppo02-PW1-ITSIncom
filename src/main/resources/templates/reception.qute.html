<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reception</title>
    <link rel="stylesheet" href="/css/styles.css" />
    <link rel="stylesheet" href="/css/reception.css">
</head>
<body>
<nav>
    <div class="filter">
        <form action="/reception/sort" method="GET">
            <label><input class="calendar" type="date" name= "dateSort" id="date" ></label>

            <label>
                <button class="search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" color="" fill="none">
                        <path d="M17.5 17.5L22 22" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M20 11C20 6.02944 15.9706 2 11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C15.9706 20 20 15.9706 20 11Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round" />
                    </svg>
                </button>
            </label>
        </form>
    </div>

    <div class="user">
        <form action="/reception/logout" method="post">
            <label>
                <button class="logout">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="" height="" color="" fill="none">
                        <path d="M15 17.625C14.9264 19.4769 13.3831 21.0494 11.3156 20.9988C10.8346 20.9871 10.2401 20.8194 9.05112 20.484C6.18961 19.6769 3.70555 18.3204 3.10956 15.2816C3 14.723 3 14.0944 3 12.8373L3 11.1627C3 9.90561 3 9.27704 3.10956 8.71845C3.70555 5.67963 6.18961 4.32314 9.05112 3.516C10.2401 3.18062 10.8346 3.01293 11.3156 3.00116C13.3831 2.95058 14.9264 4.52305 15 6.37499" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
                        <path d="M10 12H21M10 12C10 11.2998 11.9943 9.99153 12.5 9.5M10 12C10 12.7002 11.9943 14.0085 12.5 14.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                    Logout
                </button>
            </label>
        </form>
        <div class="texts">
            <p class="role">Portineria</p>
            <p class="name">Luigi Rossi</p>
        </div>
        <div class="pfp-image"></div>
    </div>
</nav>

<div class="container">
    <div class="container">
        <h2>Visite</h2>
        <div class="visite">
            {#for x in visit}
                <div class="visita">
                    <p>{x}</p>
                </div>
            {/for}

            <div class="visita">
                <span>9:00 - 10:00 | Visitatore: Luca Rossi | Stato: <span class="stato">Non iniziata</span> | Badge: <span class="badge">Non assegnato</span></span>
                <div class="badge-selector">
                    <div class="badge-circle" onclick="selezionaBadge(this, 1)">1</div>
                    <div class="badge-circle" onclick="selezionaBadge(this, 2)">2</div>
                    <div class="badge-circle" onclick="selezionaBadge(this, 3)">3</div>
                </div>
                <button class="avvia" onclick="avviaVisita(this)">Avvia</button>
            </div>
            <div class="visita">
                <span>9:00 - 10:00 | Visitatore: Luca Rossi | Stato: <span class="stato">Iniziata</span> | Badge: <span class="badge">1</span></span>
                <button class="termina" onclick="terminaVisita(this)">Termina</button>
            </div>

        </div>
        <h2>Dipendenti</h2>
        <div class="dipendenti">
            <div class="dipendenti-grid">
                <div class="dipendente">Dipendente<br>Luca Rossi</div>
                <div class="dipendente">Dipendente<br>Luca Rossi</div>
                <div class="dipendente">Dipendente<br>Luca Rossi</div>
                <div class="dipendente">Dipendente<br>Luca Rossi</div>
            </div>
        </div>
    </div>
</div>

<script>
    function selezionaBadge(element, numero) {
        let visita = element.closest(".visita");
        let stato = visita.querySelector(".stato").innerText;
        let badgeText = visita.querySelector(".badge");
        if (stato === "Non iniziata") {
            badgeText.innerText = numero;
        }
    }
    function avviaVisita(button) {
        let visita = button.parentElement;
        visita.querySelector(".stato").innerText = "Iniziata";
        button.classList.remove("avvia");
        button.classList.add("termina");
        button.innerText = "Termina";
        button.setAttribute("onclick", "terminaVisita(this)");
    }

    function terminaVisita(button) {
        let visita = button.parentElement;
        visita.querySelector(".stato").innerText = "Terminata";
        button.style.display = "none";
    }
</script>
</body>
</html>